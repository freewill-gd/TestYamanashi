package freewill.database;

import java.util.List;
import java.util.Map;

import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;

import freewill.database.DataAccess;

public class SampleDB {
	public String getText() {
		DataAccess da = new DataAccess();
		List<Map<String, Object>> result = null;
		SqlSession session = null;
        try {
        	SqlSessionFactory factory = da.getSqlSessionFactory();
        	session = factory.openSession();
        	List<Map<String, Object>> param = new List<Map<String, Object>>();
        	result = session.selectList("test.selectTest", null);
        }
        catch(Exception e) {
        	System.out.println(e.getMessage());
        }
        finally  {
        	if (session != null) session.close();
        }

        StringBuilder sb = new StringBuilder();
        if (result == null) return "";
        for (Map<String, Object> row :  result) {
        	sb.append(row.get("table_name"));
        	sb.append(".");
        	sb.append(row.get("column_name"));
        	sb.append("\r\n");
        }
        return sb.toString();
     }
}
